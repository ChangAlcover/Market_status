import * as chai from 'chai';
import * as endpoints_conections from '../src/controller/websockets_endpoints.js';

/*Testing logic in Effective price calc.*/
describe('=== Unit test ===Logic of Effective price', () => {
	it ('Logic working wrong in efect_price_logic', () =>{
		const data=[[[ 46361, 0.01 ],[ 46359.23929518, 0.001 ],[ 46358.69266685, 0.001 ],
	    [ 46347, 0.01077 ],[ 46346, 0.107771 ],[ 46345, 0.107775 ],[ 46341, 0.01 ],
	    [ 46340, 2.5 ],[ 46336, 0.01046253 ], [ 46335, 0.00024646 ],[ 46335, 0.161665 ],
	    [ 46334.21510909, 0.001 ],[ 46330, 0.00725285 ],[ 46330, 0.00731421 ],[ 46328.47966248, 0.001 ],
	    [ 46328, 0.2848 ],[ 46328, 0.1893 ],[ 46327.60915693, 0.001 ], [ 46327, 0.2411 ], [ 46327, 0.21555 ],
	    [ 46327, 0.00228 ], [ 46324, 0.07565 ], [ 46323.5374897, 0.19988204 ],[ 46322.43889041, 0.037724 ],
	    [ 46321.10551684, 0.001 ]],
	  [[ 46362, 0.314473 ],[ 46362, 0.0395 ],[ 46362, 0.19772 ],[ 46368.46475216, 0.25 ],[ 46369.67865971, 0.053892 ],
	    [ 46369.78267459, 0.00078979 ],[ 46372, 0.3 ],[ 46373.73644187, 0.107772 ],[ 46375, 0.01077 ],[ 46376.27025542, 0.107781 ],
	    [ 46380, 0.2 ],[ 46384, 0.2809 ],[ 46384, 0.2938 ], [ 46384, 0.494 ], [ 46384.19542954, 0.0538903 ], [ 46385, 0.053891 ],
	    [ 46387.25624828, 0.161664 ], [ 46389.551511, 0.161636 ], [ 46390.75022567, 0.10778013 ], [ 46392, 0.2938 ],
	    [ 46392, 0.025 ], [ 46392, 0.2809 ], [ 46392, 0.02182285 ], [ 46392, 0.107781 ],[ 46392.74924471, 0.2 ] ]];
	  const amount =2;
	  const limit_price=46492;
	  const operation ='buy';
	  const depth=25;
	  chai.expect(endpoints_conections.efect_price_logic (operation,amount,limit_price,depth,data)[0]).to.equal(92744.7597338803);
	  chai.expect(endpoints_conections.efect_price_logic (operation,amount,limit_price,depth,data)[1]).to.equal(4.11956307);
	});
});
